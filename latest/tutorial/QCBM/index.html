<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Circuit Born Machine · Quantum Algorithm Zoo</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-89508993-1', 'auto');
ga('send', 'pageview');
</script><link rel="canonical" href="https://quantumbfs.github.io/QuAlgorithmZoo.jl/latest/tutorial/QCBM/index.html"/><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Quantum Algorithm Zoo</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Tutorial</span><ul><li class="current"><a class="toctext" href>Quantum Circuit Born Machine</a><ul class="internal"><li><a class="toctext" href="#Training-target-1">Training target</a></li><li class="toplevel"><a class="toctext" href="#Build-Circuits-1">Build Circuits</a></li><li><a class="toctext" href="#Building-Blocks-1">Building Blocks</a></li><li><a class="toctext" href="#MMD-Loss-and-Gradients-1">MMD Loss &amp; Gradients</a></li><li><a class="toctext" href="#Optimizer-1">Optimizer</a></li></ul></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Tutorial</li><li><a href>Quantum Circuit Born Machine</a></li></ul><a class="edit-page" href="https://github.com/QuantumBFS/QuAlgorithmZoo.jl/blob/master/examples/QCBM.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Quantum Circuit Born Machine</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Quantum-Circuit-Born-Machine-1" href="#Quantum-Circuit-Born-Machine-1">Quantum Circuit Born Machine</a></h1><p>Quantum circuit born machine is a fresh approach to quantum machine learning. It use a parameterized quantum circuit to learning machine learning tasks with gradient based optimization. In this tutorial, we will show how to implement it with <strong>Yao</strong> (幺) framework.</p><div><pre><code class="language-julia">using Yao, Plots</code></pre></div><div><pre><code class="language-julia">@doc 幺</code></pre><pre><code class="language-none">  Extensible Framework for Quantum Algorithm Design for Humans.

  简单易用可扩展的量子算法设计框架。

  幺 means unitary in Chinese.</code></pre></div><h2><a class="nav-anchor" id="Training-target-1" href="#Training-target-1">Training target</a></h2><p>a gaussian distribution</p><div><pre><code class="language-julia">function gaussian_pdf(n, μ, σ)
    x = collect(1:1&lt;&lt;n)
    pl = @. 1 / sqrt(2pi * σ^2) * exp(-(x - μ)^2 / (2 * σ^2))
    pl / sum(pl)
end</code></pre><pre><code class="language-none">gaussian_pdf (generic function with 1 method)</code></pre></div><div>\[f(x \left| \mu, \sigma^2\right) = \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{(x-\mu)^2}{2\sigma^2}}\]</div><div><pre><code class="language-julia">const n = 6
const maxiter = 20
pg = gaussian_pdf(n, 2^5-0.5, 2^4)
fig = plot(0:1&lt;&lt;n-1, pg)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip5500">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<defs>
  <clipPath id="clip5501">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip5501)" points="
0,1600 2400,1600 2400,0 0,0 
  " fill="#ffffff" fill-opacity="1"/>
<defs>
  <clipPath id="clip5502">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip5501)" points="
94.4882,1537.01 2321.26,1537.01 2321.26,47.2441 94.4882,47.2441 
  " fill="#ffffff" fill-opacity="1"/>
<defs>
  <clipPath id="clip5503">
    <rect x="94" y="47" width="2228" height="1491"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip5503)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  157.51,1537.01 157.51,47.2441 
  "/>
<polyline clip-path="url(#clip5503)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  490.959,1537.01 490.959,47.2441 
  "/>
<polyline clip-path="url(#clip5503)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  824.408,1537.01 824.408,47.2441 
  "/>
<polyline clip-path="url(#clip5503)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1157.86,1537.01 1157.86,47.2441 
  "/>
<polyline clip-path="url(#clip5503)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1491.31,1537.01 1491.31,47.2441 
  "/>
<polyline clip-path="url(#clip5503)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1824.75,1537.01 1824.75,47.2441 
  "/>
<polyline clip-path="url(#clip5503)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2158.2,1537.01 2158.2,47.2441 
  "/>
<polyline clip-path="url(#clip5503)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1391.33 2321.26,1391.33 
  "/>
<polyline clip-path="url(#clip5503)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1083.12 2321.26,1083.12 
  "/>
<polyline clip-path="url(#clip5503)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,774.901 2321.26,774.901 
  "/>
<polyline clip-path="url(#clip5503)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,466.684 2321.26,466.684 
  "/>
<polyline clip-path="url(#clip5503)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,158.467 2321.26,158.467 
  "/>
<polyline clip-path="url(#clip5501)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1537.01 2321.26,1537.01 
  "/>
<polyline clip-path="url(#clip5501)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1537.01 94.4882,47.2441 
  "/>
<polyline clip-path="url(#clip5501)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.51,1537.01 157.51,1514.66 
  "/>
<polyline clip-path="url(#clip5501)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  490.959,1537.01 490.959,1514.66 
  "/>
<polyline clip-path="url(#clip5501)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  824.408,1537.01 824.408,1514.66 
  "/>
<polyline clip-path="url(#clip5501)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1157.86,1537.01 1157.86,1514.66 
  "/>
<polyline clip-path="url(#clip5501)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1491.31,1537.01 1491.31,1514.66 
  "/>
<polyline clip-path="url(#clip5501)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1824.75,1537.01 1824.75,1514.66 
  "/>
<polyline clip-path="url(#clip5501)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2158.2,1537.01 2158.2,1514.66 
  "/>
<polyline clip-path="url(#clip5501)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1391.33 127.89,1391.33 
  "/>
<polyline clip-path="url(#clip5501)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1083.12 127.89,1083.12 
  "/>
<polyline clip-path="url(#clip5501)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,774.901 127.89,774.901 
  "/>
<polyline clip-path="url(#clip5501)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,466.684 127.89,466.684 
  "/>
<polyline clip-path="url(#clip5501)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,158.467 127.89,158.467 
  "/>
<g clip-path="url(#clip5501)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 157.51, 1591.01)" x="157.51" y="1591.01">0</text>
</g>
<g clip-path="url(#clip5501)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 490.959, 1591.01)" x="490.959" y="1591.01">10</text>
</g>
<g clip-path="url(#clip5501)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 824.408, 1591.01)" x="824.408" y="1591.01">20</text>
</g>
<g clip-path="url(#clip5501)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 1157.86, 1591.01)" x="1157.86" y="1591.01">30</text>
</g>
<g clip-path="url(#clip5501)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 1491.31, 1591.01)" x="1491.31" y="1591.01">40</text>
</g>
<g clip-path="url(#clip5501)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 1824.75, 1591.01)" x="1824.75" y="1591.01">50</text>
</g>
<g clip-path="url(#clip5501)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 2158.2, 1591.01)" x="2158.2" y="1591.01">60</text>
</g>
<g clip-path="url(#clip5501)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:end;" transform="rotate(0, 70.4882, 1408.83)" x="70.4882" y="1408.83">0.005</text>
</g>
<g clip-path="url(#clip5501)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:end;" transform="rotate(0, 70.4882, 1100.62)" x="70.4882" y="1100.62">0.010</text>
</g>
<g clip-path="url(#clip5501)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:end;" transform="rotate(0, 70.4882, 792.401)" x="70.4882" y="792.401">0.015</text>
</g>
<g clip-path="url(#clip5501)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:end;" transform="rotate(0, 70.4882, 484.184)" x="70.4882" y="484.184">0.020</text>
</g>
<g clip-path="url(#clip5501)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:end;" transform="rotate(0, 70.4882, 175.967)" x="70.4882" y="175.967">0.025</text>
</g>
<polyline clip-path="url(#clip5503)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.51,1437.73 190.855,1405.17 224.2,1369.87 257.545,1331.76 290.89,1290.85 324.234,1247.16 357.579,1200.75 390.924,1151.73 424.269,1100.23 457.614,1046.45 
  490.959,990.615 524.304,933.008 557.649,873.952 590.994,813.812 624.338,752.997 657.683,691.949 691.028,631.146 724.373,571.09 757.718,512.306 791.063,455.328 
  824.408,400.701 857.753,348.96 891.098,300.634 924.442,256.228 957.787,216.217 991.132,181.041 1024.48,151.091 1057.82,126.706 1091.17,108.166 1124.51,95.6846 
  1157.86,89.4072 1191.2,89.4072 1224.55,95.6846 1257.89,108.166 1291.24,126.706 1324.58,151.091 1357.93,181.041 1391.27,216.217 1424.62,256.228 1457.96,300.634 
  1491.31,348.96 1524.65,400.701 1558,455.328 1591.34,512.306 1624.69,571.09 1658.03,631.146 1691.37,691.949 1724.72,752.997 1758.06,813.812 1791.41,873.952 
  1824.75,933.008 1858.1,990.615 1891.44,1046.45 1924.79,1100.23 1958.13,1151.73 1991.48,1200.75 2024.82,1247.16 2058.17,1290.85 2091.51,1331.76 2124.86,1369.87 
  2158.2,1405.17 2191.55,1437.73 2224.89,1467.59 2258.24,1494.84 
  "/>
<polygon clip-path="url(#clip5501)" points="
1958.43,251.724 2249.26,251.724 2249.26,130.764 1958.43,130.764 
  " fill="#ffffff" fill-opacity="1"/>
<polyline clip-path="url(#clip5501)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1958.43,251.724 2249.26,251.724 2249.26,130.764 1958.43,130.764 1958.43,251.724 
  "/>
<polyline clip-path="url(#clip5501)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1982.43,191.244 2126.43,191.244 
  "/>
<g clip-path="url(#clip5501)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:start;" transform="rotate(0, 2150.43, 208.744)" x="2150.43" y="208.744">y1</text>
</g>
</svg>
</div><h1><a class="nav-anchor" id="Build-Circuits-1" href="#Build-Circuits-1">Build Circuits</a></h1><h2><a class="nav-anchor" id="Building-Blocks-1" href="#Building-Blocks-1">Building Blocks</a></h2><p>Gates are grouped to become a layer in a circuit, this layer can be <strong>Arbitrary Rotation</strong> or <strong>CNOT entangler</strong>. Which are used as our basic building blocks of <strong>Born Machines</strong>.</p><h3><a class="nav-anchor" id="Arbitrary-Rotation-1" href="#Arbitrary-Rotation-1">Arbitrary Rotation</a></h3><p>Arbitrary Rotation is built with <strong>Rotation Gate on Z</strong>, <strong>Rotation Gate on X</strong> and <strong>Rotation Gate on Z</strong>:</p><div>\[Rz(\theta) \cdot Rx(\theta) \cdot Rz(\theta)\]</div><p>Since our input will be a <span>$|0\dots 0\rangle$</span> state. The first layer of arbitrary rotation can just use <span>$Rx(\theta) \cdot Rz(\theta)$</span> and the last layer of arbitrary rotation could just use <span>$Rz(\theta)\cdot Rx(\theta)$</span></p><p>In <strong>幺</strong>, every Hilbert operator is a <strong>block</strong> type, this includes all <strong>quantum gates</strong> and <strong>quantum oracles</strong>. In general, operators appears in a quantum circuit can be divided into <strong>Composite Blocks</strong> and <strong>Primitive Blocks</strong>.</p><p>We follow the low abstraction principle and thus each block represents a certain approach of calculation. The simplest <strong>Composite Block</strong> is a <strong>Chain Block</strong>, which chains other blocks (oracles) with the same number of qubits together. It is just a simple mathematical composition of operators with same size. e.g.</p><div>\[\text{chain(X, Y, Z)} \iff X \cdot Y \cdot Z\]</div><p>We can construct an arbitrary rotation block by chain <span>$Rz$</span>, <span>$Rx$</span>, <span>$Rz$</span> together.</p><div><pre><code class="language-julia">chain(Rz(0), Rx(0), Rz(0))</code></pre><pre><code class="language-none">Total: 1, DataType: Complex{Float64}
chain
├─ Rot Z gate: 0.0
├─ Rot X gate: 0.0
└─ Rot Z gate: 0.0</code></pre></div><div><pre><code class="language-julia">chain(X)</code></pre><pre><code class="language-none">Total: 1, DataType: Complex{Float64}
chain
└─ X gate</code></pre></div><p><code>Rx</code>, <code>Ry</code> and <code>Rz</code> will construct new rotation gate, which are just shorthands for <code>rot(X, 0.0)</code>, etc.</p><p>Then, let&#39;s pile them up vertically with another method called <strong>rollrepeat</strong></p><div><pre><code class="language-julia">layer(x::Symbol) = layer(Val(x))
layer(::Val{:first}) = rollrepeat(chain(Rx(0), Rz(0)))
rollrepeat(chain(Rx(0), Rz(0)))(4)</code></pre><pre><code class="language-none">Total: 4, DataType: Complex{Float64}
roller
├─ chain
│  ├─ Rot X gate: 0.0
│  └─ Rot Z gate: 0.0
├─ chain
│  ├─ Rot X gate: 0.0
│  └─ Rot Z gate: 0.0
├─ chain
│  ├─ Rot X gate: 0.0
│  └─ Rot Z gate: 0.0
└─ chain
   ├─ Rot X gate: 0.0
   └─ Rot Z gate: 0.0</code></pre></div><p>In <strong>幺</strong>, the factory method <strong>rollrepeat</strong> will construct a block called <strong>Roller</strong>. It is mathematically equivalent to the kronecker product of all operators in this layer:</p><div>\[rollrepeat(n, U) \iff roll(n, \text{i=&gt;U for i = 1:n}) \iff kron(n, \text{i=&gt;U for i=1:n}) \iff U \otimes \dots \otimes U\]</div><div><pre><code class="language-julia">@doc Val</code></pre><pre><code class="language-none">  Val(c)

  Return Val{c}(), which contains no run-time data. Types like this can be
  used to pass the information between functions through the value c, which
  must be an isbits value. The intent of this construct is to be able to
  dispatch on constants directly (at compile time) without having to test the
  value of the constant at run time.

  Examples
  ≡≡≡≡≡≡≡≡≡≡

  julia&gt; f(::Val{true}) = &quot;Good&quot;
  f (generic function with 1 method)

  julia&gt; f(::Val{false}) = &quot;Bad&quot;
  f (generic function with 2 methods)

  julia&gt; f(Val(true))
  &quot;Good&quot;</code></pre></div><div><pre><code class="language-julia">roll(4, i=&gt;X for i = 1:4)</code></pre><pre><code class="language-none">Total: 4, DataType: Complex{Float64}
roller
├─ X gate
├─ X gate
├─ X gate
└─ X gate</code></pre></div><div><pre><code class="language-julia">rollrepeat(4, X)</code></pre><pre><code class="language-none">Total: 4, DataType: Complex{Float64}
roller
├─ X gate
├─ X gate
├─ X gate
└─ X gate</code></pre></div><div><pre><code class="language-julia">kron(4, i=&gt;X for i = 1:4)</code></pre><pre><code class="language-none">Total: 4, DataType: Complex{Float64}
kron
├─ 1=&gt;X gate
├─ 2=&gt;X gate
├─ 3=&gt;X gate
└─ 4=&gt;X gate</code></pre></div><p>However, <code>kron</code> is calculated differently comparing to <code>roll</code>. In principal, <strong>Roller</strong> will be able to calculate small blocks with same size with higher efficiency. But for large blocks <strong>Roller</strong> may be slower. In <strong>幺</strong>, we offer you this freedom to choose the most suitable solution.</p><p>all factory methods will <strong>lazy</strong> evaluate <strong>the first arguements</strong>, which is the number of qubits. It will return a lambda function that requires a single interger input. The instance of desired block will only be constructed until all the information is filled.</p><div><pre><code class="language-julia">rollrepeat(X)</code></pre><pre><code class="language-none">#33 (generic function with 1 method)</code></pre></div><div><pre><code class="language-julia">rollrepeat(X)(4)</code></pre><pre><code class="language-none">Total: 4, DataType: Complex{Float64}
roller
├─ X gate
├─ X gate
├─ X gate
└─ X gate</code></pre></div><p>When you filled all the information in somewhere of the declaration, 幺 will be able to infer the others.</p><div><pre><code class="language-julia">chain(4, rollrepeat(X), rollrepeat(Y))</code></pre><pre><code class="language-none">Total: 4, DataType: Complex{Float64}
chain
├─ roller
│  ├─ X gate
│  ├─ X gate
│  ├─ X gate
│  └─ X gate
└─ roller
   ├─ Y gate
   ├─ Y gate
   ├─ Y gate
   └─ Y gate</code></pre></div><p>We will now define the rest of rotation layers</p><div><pre><code class="language-julia">layer(::Val{:last}) = rollrepeat(chain(Rz(0), Rx(0)))
layer(::Val{:mid}) = rollrepeat(chain(Rz(0), Rx(0), Rz(0)))</code></pre><pre><code class="language-none">layer (generic function with 4 methods)</code></pre></div><h3><a class="nav-anchor" id="CNOT-Entangler-1" href="#CNOT-Entangler-1">CNOT Entangler</a></h3><p>Another component of quantum circuit born machine is several <strong>CNOT</strong> operators applied on different qubits.</p><div><pre><code class="language-julia">entangler(pairs) = chain(control([ctrl, ], target=&gt;X) for (ctrl, target) in pairs)</code></pre><pre><code class="language-none">entangler (generic function with 1 method)</code></pre></div><p>We can then define such a born machine</p><div><pre><code class="language-julia">function QCBM(n, nlayer, pairs)
    circuit = chain(n)
    push!(circuit, layer(:first))

    for i = 1:(nlayer - 1)
        push!(circuit, cache(entangler(pairs)))
        push!(circuit, layer(:mid))
    end

    push!(circuit, cache(entangler(pairs)))
    push!(circuit, layer(:last))

    circuit
end</code></pre><pre><code class="language-none">QCBM (generic function with 1 method)</code></pre></div><p>We use the method <code>cache</code> here to tag the entangler block that it should be cached after its first run, because it is actually a constant oracle. Let&#39;s see what will be constructed</p><div><pre><code class="language-julia">QCBM(4, 1, [1=&gt;2, 2=&gt;3, 3=&gt;4, 4=&gt;1])</code></pre><pre><code class="language-none">Total: 4, DataType: Complex{Float64}
chain
├─ roller
│  ├─ chain
│  │  ├─ Rot X gate: 0.0
│  │  └─ Rot Z gate: 0.0
│  ├─ chain
│  │  ├─ Rot X gate: 0.0
│  │  └─ Rot Z gate: 0.0
│  ├─ chain
│  │  ├─ Rot X gate: 0.0
│  │  └─ Rot Z gate: 0.0
│  └─ chain
│     ├─ Rot X gate: 0.0
│     └─ Rot Z gate: 0.0
├─ chain (Cached)
│  ├─ control(1)
│  │  └─ (2,)=&gt;X gate
│  ├─ control(2)
│  │  └─ (3,)=&gt;X gate
│  ├─ control(3)
│  │  └─ (4,)=&gt;X gate
│  └─ control(4)
│     └─ (1,)=&gt;X gate
└─ roller
   ├─ chain
   │  ├─ Rot Z gate: 0.0
   │  └─ Rot X gate: 0.0
   ├─ chain
   │  ├─ Rot Z gate: 0.0
   │  └─ Rot X gate: 0.0
   ├─ chain
   │  ├─ Rot Z gate: 0.0
   │  └─ Rot X gate: 0.0
   └─ chain
      ├─ Rot Z gate: 0.0
      └─ Rot X gate: 0.0</code></pre></div><h2><a class="nav-anchor" id="MMD-Loss-and-Gradients-1" href="#MMD-Loss-and-Gradients-1">MMD Loss &amp; Gradients</a></h2><p>The MMD loss is describe below:</p><div>\[\begin{aligned}
\mathcal{L} &amp;= \left| \sum_{x} p \theta(x) \phi(x) - \sum_{x} \pi(x) \phi(x) \right|^2\\
            &amp;= \langle K(x, y) \rangle_{x \sim p_{\theta}, y\sim p_{\theta}} - 2 \langle K(x, y)
                  \rangle_{x\sim p_{\theta}, y\sim \pi} + \langle K(x, y) \rangle_{x\sim\pi, y\sim\pi}
\end{aligned}\]</div><p>We will use a squared exponential kernel here.</p><div><pre><code class="language-julia">struct Kernel
    sigma::Float64
    matrix::Matrix{Float64}
end

function Kernel(nqubits, sigma)
    basis = collect(0:(1&lt;&lt;nqubits - 1))
    Kernel(sigma, kernel_matrix(basis, basis, sigma))
end

expect(kernel::Kernel, px::Vector{Float64}, py::Vector{Float64}) = px&#39; * kernel.matrix * py
loss(qcbm, kernel::Kernel, ptrain) = (p = get_prob(qcbm) - ptrain; expect(kernel, p, p))</code></pre><pre><code class="language-none">loss (generic function with 1 method)</code></pre></div><p>Next, let&#39;s define the kernel matrix</p><div><pre><code class="language-julia">function kernel_matrix(x, y, sigma)
    dx2 = (x .- y&#39;).^2
    gamma = 1.0 / (2 * sigma)
    K = exp.(-gamma * dx2)
    K
end</code></pre><pre><code class="language-none">kernel_matrix (generic function with 1 method)</code></pre></div><h3><a class="nav-anchor" id="Gradients-1" href="#Gradients-1">Gradients</a></h3><p>the gradient of MMD loss is</p><div>\[\begin{aligned}
\frac{\partial \mathcal{L}}{\partial \theta^i_l} &amp;= \langle K(x, y) \rangle_{x\sim p_{\theta^+}, y\sim p_{\theta}} - \langle K(x, y) \rangle_{x\sim p_{\theta}^-, y\sim p_{\theta}}\\
&amp;- \langle K(x, y) \rangle _{x\sim p_{\theta^+}, y\sim\pi} + \langle K(x, y) \rangle_{x\sim p_{\theta^-}, y\sim\pi}
\end{aligned}\]</div><p>We have to update one parameter of each rotation gate each time, and calculate its gradient then collect them. Since we will need to calculate the probability from the state vector frequently, let&#39;s define a shorthand first.</p><p>Firstly, you have to define a quantum register. Each run of a QCBM&#39;s input is a simple <span>$|00\cdots 0\rangle$</span> state. We provide string literal <code>bit</code> to help you define one-hot state vectors like this</p><div><pre><code class="language-julia">r = register(bit&quot;0000&quot;)</code></pre><pre><code class="language-none">DefaultRegister{1, Complex{Float64}}
    active qubits: 4/4</code></pre></div><div><pre><code class="language-julia">circuit = QCBM(6, 10, [1=&gt;2, 3=&gt;4, 5=&gt;6, 2=&gt;3, 4=&gt;5, 6=&gt;1]);</code></pre></div><p>Now, we define its shorthand</p><div><pre><code class="language-julia">get_prob(qcbm) = apply!(register(bit&quot;0&quot;^nqubits(qcbm)), qcbm) |&gt; statevec .|&gt; abs2</code></pre><pre><code class="language-none">get_prob (generic function with 1 method)</code></pre></div><p>We will first iterate through each layer contains rotation gates and allocate an array to store our gradient</p><div><pre><code class="language-julia">function gradient(n, nlayers, qcbm, kernel, ptrain)
    prob = get_prob(qcbm)
    grad = zeros(real(datatype(qcbm)), nparameters(qcbm))
    idx = 0
    for ilayer = 1:2:(2 * nlayers + 1)
        idx = grad_layer!(grad, idx, prob, qcbm, qcbm[ilayer], kernel, ptrain)
    end
    grad
end</code></pre><pre><code class="language-none">gradient (generic function with 1 method)</code></pre></div><p>Then we iterate through each rotation gate.</p><div><pre><code class="language-julia">function grad_layer!(grad, idx, prob, qcbm, layer, kernel, ptrain)
    count = idx
    for each_line in blocks(layer)
        for each in blocks(each_line)
            gradient!(grad, count+1, prob, qcbm, each, kernel, ptrain)
            count += 1
        end
    end
    count
end</code></pre><pre><code class="language-none">grad_layer! (generic function with 1 method)</code></pre></div><p>We update each parameter by rotate it <span>$-\pi/2$</span> and <span>$\pi/2$</span></p><div><pre><code class="language-julia">function gradient!(grad, idx, prob, qcbm, gate, kernel, ptrain)
    dispatch!(+, gate, pi / 2)
    prob_pos = get_prob(qcbm)

    dispatch!(-, gate, pi)
    prob_neg = get_prob(qcbm)

    dispatch!(+, gate, pi / 2) # set back

    grad_pos = expect(kernel, prob, prob_pos) - expect(kernel, prob, prob_neg)
    grad_neg = expect(kernel, ptrain, prob_pos) - expect(kernel, ptrain, prob_neg)
    grad[idx] = grad_pos - grad_neg
    grad
end</code></pre><pre><code class="language-none">gradient! (generic function with 1 method)</code></pre></div><h2><a class="nav-anchor" id="Optimizer-1" href="#Optimizer-1">Optimizer</a></h2><p>We will use the Adam optimizer. Since we don&#39;t want you to install another package for this, the following code for this optimizer is copied from <a href="https://github.com/denizyuret/Knet.jl">Knet.jl</a></p><p>Reference: <a href="https://arxiv.org/abs/1412.6980">Kingma, D. P., &amp; Ba, J. L. (2015)</a>. Adam: a Method for Stochastic Optimization. International Conference on Learning Representations, 1–13.</p><div><pre><code class="language-julia">using LinearAlgebra

mutable struct Adam
    lr::AbstractFloat
    gclip::AbstractFloat
    beta1::AbstractFloat
    beta2::AbstractFloat
    eps::AbstractFloat
    t::Int
    fstm
    scndm
end

Adam(; lr=0.001, gclip=0, beta1=0.9, beta2=0.999, eps=1e-8)=Adam(lr, gclip, beta1, beta2, eps, 0, nothing, nothing)

function update!(w, g, p::Adam)
    gclip!(g, p.gclip)
    if p.fstm===nothing; p.fstm=zero(w); p.scndm=zero(w); end
    p.t += 1
    lmul!(p.beta1, p.fstm)
    BLAS.axpy!(1-p.beta1, g, p.fstm)
    lmul!(p.beta2, p.scndm)
    BLAS.axpy!(1-p.beta2, g .* g, p.scndm)
    fstm_corrected = p.fstm / (1 - p.beta1 ^ p.t)
    scndm_corrected = p.scndm / (1 - p.beta2 ^ p.t)
    BLAS.axpy!(-p.lr, @.(fstm_corrected / (sqrt(scndm_corrected) + p.eps)), w)
end

function gclip!(g, gclip)
    if gclip == 0
        g
    else
        gnorm = vecnorm(g)
        if gnorm &lt;= gclip
            g
        else
            BLAS.scale!(gclip/gnorm, g)
        end
    end
end</code></pre><pre><code class="language-none">gclip! (generic function with 1 method)</code></pre></div><p>The training of the quantum circuit is simple, just iterate through the steps.</p><div><pre><code class="language-julia">function train!(qcbm, ptrain, optim; learning_rate=0.1, niter=50)</code></pre></div><p>initialize the parameters</p><div><pre><code class="language-julia">    params = 2pi * rand(nparameters(qcbm))
    dispatch!(qcbm, params)
    kernel = Kernel(nqubits(qcbm), 0.25)

    n, nlayers = nqubits(qcbm), (length(qcbm)-1)÷2
    history = Float64[]

    for i = 1:niter
        grad = gradient(n, nlayers, qcbm, kernel, ptrain)
        curr_loss = loss(qcbm, kernel, ptrain)
        push!(history, curr_loss)
        params = collect(parameters(qcbm))
        update!(params, grad, optim)
        dispatch!(qcbm, params)
    end
    history
end</code></pre><pre><code class="language-none">train! (generic function with 1 method)</code></pre></div><div><pre><code class="language-julia">optim = Adam(lr=0.1)
his = train!(circuit, pg, optim, niter=50, learning_rate=0.1)
plot(1:50, his, xlabel=&quot;iteration&quot;, ylabel=&quot;loss&quot;)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip5600">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<defs>
  <clipPath id="clip5601">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip5601)" points="
0,1600 2400,1600 2400,0 0,0 
  " fill="#ffffff" fill-opacity="1"/>
<defs>
  <clipPath id="clip5602">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip5601)" points="
157.48,1474.02 2321.26,1474.02 2321.26,47.2441 157.48,47.2441 
  " fill="#ffffff" fill-opacity="1"/>
<defs>
  <clipPath id="clip5603">
    <rect x="157" y="47" width="2165" height="1428"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip5603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  177.06,1474.02 177.06,47.2441 
  "/>
<polyline clip-path="url(#clip5603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  593.652,1474.02 593.652,47.2441 
  "/>
<polyline clip-path="url(#clip5603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1010.24,1474.02 1010.24,47.2441 
  "/>
<polyline clip-path="url(#clip5603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1426.84,1474.02 1426.84,47.2441 
  "/>
<polyline clip-path="url(#clip5603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1843.43,1474.02 1843.43,47.2441 
  "/>
<polyline clip-path="url(#clip5603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2260.02,1474.02 2260.02,47.2441 
  "/>
<polyline clip-path="url(#clip5603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  157.48,1436.28 2321.26,1436.28 
  "/>
<polyline clip-path="url(#clip5603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  157.48,1084.85 2321.26,1084.85 
  "/>
<polyline clip-path="url(#clip5603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  157.48,733.421 2321.26,733.421 
  "/>
<polyline clip-path="url(#clip5603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  157.48,381.991 2321.26,381.991 
  "/>
<polyline clip-path="url(#clip5601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.48,1474.02 2321.26,1474.02 
  "/>
<polyline clip-path="url(#clip5601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.48,1474.02 157.48,47.2441 
  "/>
<polyline clip-path="url(#clip5601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  177.06,1474.02 177.06,1452.61 
  "/>
<polyline clip-path="url(#clip5601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  593.652,1474.02 593.652,1452.61 
  "/>
<polyline clip-path="url(#clip5601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1010.24,1474.02 1010.24,1452.61 
  "/>
<polyline clip-path="url(#clip5601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1426.84,1474.02 1426.84,1452.61 
  "/>
<polyline clip-path="url(#clip5601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1843.43,1474.02 1843.43,1452.61 
  "/>
<polyline clip-path="url(#clip5601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2260.02,1474.02 2260.02,1452.61 
  "/>
<polyline clip-path="url(#clip5601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.48,1436.28 189.937,1436.28 
  "/>
<polyline clip-path="url(#clip5601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.48,1084.85 189.937,1084.85 
  "/>
<polyline clip-path="url(#clip5601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.48,733.421 189.937,733.421 
  "/>
<polyline clip-path="url(#clip5601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.48,381.991 189.937,381.991 
  "/>
<g clip-path="url(#clip5601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 177.06, 1528.02)" x="177.06" y="1528.02">0</text>
</g>
<g clip-path="url(#clip5601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 593.652, 1528.02)" x="593.652" y="1528.02">10</text>
</g>
<g clip-path="url(#clip5601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 1010.24, 1528.02)" x="1010.24" y="1528.02">20</text>
</g>
<g clip-path="url(#clip5601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 1426.84, 1528.02)" x="1426.84" y="1528.02">30</text>
</g>
<g clip-path="url(#clip5601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 1843.43, 1528.02)" x="1843.43" y="1528.02">40</text>
</g>
<g clip-path="url(#clip5601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 2260.02, 1528.02)" x="2260.02" y="1528.02">50</text>
</g>
<g clip-path="url(#clip5601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:end;" transform="rotate(0, 133.48, 1453.78)" x="133.48" y="1453.78">0.000</text>
</g>
<g clip-path="url(#clip5601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:end;" transform="rotate(0, 133.48, 1102.35)" x="133.48" y="1102.35">0.005</text>
</g>
<g clip-path="url(#clip5601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:end;" transform="rotate(0, 133.48, 750.921)" x="133.48" y="750.921">0.010</text>
</g>
<g clip-path="url(#clip5601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:end;" transform="rotate(0, 133.48, 399.491)" x="133.48" y="399.491">0.015</text>
</g>
<g clip-path="url(#clip5601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66; text-anchor:middle;" transform="rotate(0, 1239.37, 1590.4)" x="1239.37" y="1590.4">iteration</text>
</g>
<g clip-path="url(#clip5601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66; text-anchor:middle;" transform="rotate(-90, 57.6, 760.63)" x="57.6" y="760.63">loss</text>
</g>
<polyline clip-path="url(#clip5603)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  218.719,87.6244 260.379,527.116 302.038,912.369 343.697,883.297 385.356,1012.15 427.015,1080.78 468.675,1083.57 510.334,1136.97 551.993,1224.71 593.652,1251.5 
  635.311,1276.68 676.971,1303.08 718.63,1322.79 760.289,1332.49 801.948,1330.47 843.608,1340.66 885.267,1351.38 926.926,1367.82 968.585,1388.01 1010.24,1380.74 
  1051.9,1381 1093.56,1382.48 1135.22,1388.38 1176.88,1400.87 1218.54,1402.42 1260.2,1404.19 1301.86,1406.95 1343.52,1409.14 1385.18,1415.21 1426.84,1418.28 
  1468.5,1415.58 1510.15,1418.75 1551.81,1418.73 1593.47,1419.41 1635.13,1423.32 1676.79,1424.08 1718.45,1424.15 1760.11,1425.4 1801.77,1426.93 1843.43,1428.29 
  1885.09,1428.63 1926.75,1428.97 1968.41,1429.84 2010.07,1430.32 2051.72,1431.94 2093.38,1432.47 2135.04,1432.98 2176.7,1433.29 2218.36,1433.02 2260.02,1433.64 
  
  "/>
<polygon clip-path="url(#clip5601)" points="
1958.43,251.724 2249.26,251.724 2249.26,130.764 1958.43,130.764 
  " fill="#ffffff" fill-opacity="1"/>
<polyline clip-path="url(#clip5601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1958.43,251.724 2249.26,251.724 2249.26,130.764 1958.43,130.764 1958.43,251.724 
  "/>
<polyline clip-path="url(#clip5601)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1982.43,191.244 2126.43,191.244 
  "/>
<g clip-path="url(#clip5601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:start;" transform="rotate(0, 2150.43, 208.744)" x="2150.43" y="208.744">y1</text>
</g>
</svg>
</div><div><pre><code class="language-julia">p = get_prob(circuit)
p = plot(0:1&lt;&lt;n-1, p, xlabel=&quot;x&quot;, ylabel=&quot;p&quot;)
plot!(p, 0:1&lt;&lt;n-1, pg)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip5700">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<defs>
  <clipPath id="clip5701">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip5701)" points="
0,1600 2400,1600 2400,0 0,0 
  " fill="#ffffff" fill-opacity="1"/>
<defs>
  <clipPath id="clip5702">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip5701)" points="
157.48,1474.02 2321.26,1474.02 2321.26,47.2441 157.48,47.2441 
  " fill="#ffffff" fill-opacity="1"/>
<defs>
  <clipPath id="clip5703">
    <rect x="157" y="47" width="2165" height="1428"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip5703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  218.719,1474.02 218.719,47.2441 
  "/>
<polyline clip-path="url(#clip5703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  542.735,1474.02 542.735,47.2441 
  "/>
<polyline clip-path="url(#clip5703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  866.752,1474.02 866.752,47.2441 
  "/>
<polyline clip-path="url(#clip5703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1190.77,1474.02 1190.77,47.2441 
  "/>
<polyline clip-path="url(#clip5703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1514.78,1474.02 1514.78,47.2441 
  "/>
<polyline clip-path="url(#clip5703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1838.8,1474.02 1838.8,47.2441 
  "/>
<polyline clip-path="url(#clip5703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2162.82,1474.02 2162.82,47.2441 
  "/>
<polyline clip-path="url(#clip5703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  157.48,1339.61 2321.26,1339.61 
  "/>
<polyline clip-path="url(#clip5703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  157.48,1059.65 2321.26,1059.65 
  "/>
<polyline clip-path="url(#clip5703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  157.48,779.681 2321.26,779.681 
  "/>
<polyline clip-path="url(#clip5703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  157.48,499.714 2321.26,499.714 
  "/>
<polyline clip-path="url(#clip5703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  157.48,219.748 2321.26,219.748 
  "/>
<polyline clip-path="url(#clip5701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.48,1474.02 2321.26,1474.02 
  "/>
<polyline clip-path="url(#clip5701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.48,1474.02 157.48,47.2441 
  "/>
<polyline clip-path="url(#clip5701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  218.719,1474.02 218.719,1452.61 
  "/>
<polyline clip-path="url(#clip5701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  542.735,1474.02 542.735,1452.61 
  "/>
<polyline clip-path="url(#clip5701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  866.752,1474.02 866.752,1452.61 
  "/>
<polyline clip-path="url(#clip5701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1190.77,1474.02 1190.77,1452.61 
  "/>
<polyline clip-path="url(#clip5701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1514.78,1474.02 1514.78,1452.61 
  "/>
<polyline clip-path="url(#clip5701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1838.8,1474.02 1838.8,1452.61 
  "/>
<polyline clip-path="url(#clip5701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2162.82,1474.02 2162.82,1452.61 
  "/>
<polyline clip-path="url(#clip5701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.48,1339.61 189.937,1339.61 
  "/>
<polyline clip-path="url(#clip5701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.48,1059.65 189.937,1059.65 
  "/>
<polyline clip-path="url(#clip5701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.48,779.681 189.937,779.681 
  "/>
<polyline clip-path="url(#clip5701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.48,499.714 189.937,499.714 
  "/>
<polyline clip-path="url(#clip5701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.48,219.748 189.937,219.748 
  "/>
<g clip-path="url(#clip5701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 218.719, 1528.02)" x="218.719" y="1528.02">0</text>
</g>
<g clip-path="url(#clip5701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 542.735, 1528.02)" x="542.735" y="1528.02">10</text>
</g>
<g clip-path="url(#clip5701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 866.752, 1528.02)" x="866.752" y="1528.02">20</text>
</g>
<g clip-path="url(#clip5701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 1190.77, 1528.02)" x="1190.77" y="1528.02">30</text>
</g>
<g clip-path="url(#clip5701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 1514.78, 1528.02)" x="1514.78" y="1528.02">40</text>
</g>
<g clip-path="url(#clip5701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 1838.8, 1528.02)" x="1838.8" y="1528.02">50</text>
</g>
<g clip-path="url(#clip5701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:middle;" transform="rotate(0, 2162.82, 1528.02)" x="2162.82" y="1528.02">60</text>
</g>
<g clip-path="url(#clip5701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:end;" transform="rotate(0, 133.48, 1357.11)" x="133.48" y="1357.11">0.005</text>
</g>
<g clip-path="url(#clip5701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:end;" transform="rotate(0, 133.48, 1077.15)" x="133.48" y="1077.15">0.010</text>
</g>
<g clip-path="url(#clip5701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:end;" transform="rotate(0, 133.48, 797.181)" x="133.48" y="797.181">0.015</text>
</g>
<g clip-path="url(#clip5701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:end;" transform="rotate(0, 133.48, 517.214)" x="133.48" y="517.214">0.020</text>
</g>
<g clip-path="url(#clip5701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:end;" transform="rotate(0, 133.48, 237.248)" x="133.48" y="237.248">0.025</text>
</g>
<g clip-path="url(#clip5701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66; text-anchor:middle;" transform="rotate(0, 1239.37, 1590.4)" x="1239.37" y="1590.4">x</text>
</g>
<g clip-path="url(#clip5701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66; text-anchor:middle;" transform="rotate(-90, 57.6, 760.63)" x="57.6" y="760.63">p</text>
</g>
<polyline clip-path="url(#clip5703)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  218.719,1369.12 251.121,1389.17 283.523,1256.98 315.924,1281.09 348.326,1198.85 380.727,1197.33 413.129,1230.39 445.531,1182.44 477.932,1105.47 510.334,970.558 
  542.735,1034.63 575.137,901.475 607.539,818.712 639.94,877.094 672.342,727.92 704.744,722.961 737.145,730.073 769.547,567.373 801.948,533.005 834.35,480.867 
  866.752,466.042 899.153,383.55 931.555,310.039 963.956,270.515 996.358,313.263 1028.76,267.821 1061.16,136.535 1093.56,231.885 1125.96,150.646 1158.37,87.6244 
  1190.77,275.583 1223.17,208.318 1255.57,148.33 1287.97,127.598 1320.37,202.474 1352.78,217.511 1385.18,281.708 1417.58,281.908 1449.98,283.39 1482.38,325.577 
  1514.78,434.953 1547.19,444.687 1579.59,471.554 1611.99,529.991 1644.39,566.733 1676.79,722.39 1709.19,695.758 1741.6,728.76 1774,835.572 1806.4,906.741 
  1838.8,962.107 1871.2,863.149 1903.6,1023.86 1936,1078.11 1968.41,1078.37 2000.81,1230.77 2033.21,1210.57 2065.61,1184.36 2098.01,1332.69 2130.41,1261.73 
  2162.82,1420.57 2195.22,1308.56 2227.62,1433.53 2260.02,1388.46 
  "/>
<polyline clip-path="url(#clip5703)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  218.719,1381.75 251.121,1352.18 283.523,1320.11 315.924,1285.5 348.326,1248.34 380.727,1208.65 413.129,1166.5 445.531,1121.97 477.932,1075.19 510.334,1026.34 
  542.735,975.623 575.137,923.296 607.539,869.653 639.94,815.026 672.342,759.784 704.744,704.332 737.145,649.102 769.547,594.551 801.948,541.155 834.35,489.4 
  866.752,439.779 899.153,392.781 931.555,348.885 963.956,308.549 996.358,272.206 1028.76,240.253 1061.16,213.049 1093.56,190.899 1125.96,174.058 1158.37,162.721 
  1190.77,157.019 1223.17,157.019 1255.57,162.721 1287.97,174.058 1320.37,190.899 1352.78,213.049 1385.18,240.253 1417.58,272.206 1449.98,308.549 1482.38,348.885 
  1514.78,392.781 1547.19,439.779 1579.59,489.4 1611.99,541.155 1644.39,594.551 1676.79,649.102 1709.19,704.332 1741.6,759.784 1774,815.026 1806.4,869.653 
  1838.8,923.296 1871.2,975.623 1903.6,1026.34 1936,1075.19 1968.41,1121.97 2000.81,1166.5 2033.21,1208.65 2065.61,1248.34 2098.01,1285.5 2130.41,1320.11 
  2162.82,1352.18 2195.22,1381.75 2227.62,1408.88 2260.02,1433.64 
  "/>
<polygon clip-path="url(#clip5701)" points="
1958.43,312.204 2249.26,312.204 2249.26,130.764 1958.43,130.764 
  " fill="#ffffff" fill-opacity="1"/>
<polyline clip-path="url(#clip5701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1958.43,312.204 2249.26,312.204 2249.26,130.764 1958.43,130.764 1958.43,312.204 
  "/>
<polyline clip-path="url(#clip5701)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1982.43,191.244 2126.43,191.244 
  "/>
<g clip-path="url(#clip5701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:start;" transform="rotate(0, 2150.43, 208.744)" x="2150.43" y="208.744">y1</text>
</g>
<polyline clip-path="url(#clip5701)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1982.43,251.724 2126.43,251.724 
  "/>
<g clip-path="url(#clip5701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48; text-anchor:start;" transform="rotate(0, 2150.43, 269.224)" x="2150.43" y="269.224">y2</text>
</g>
</svg>
</div><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../../"><span class="direction">Previous</span><span class="title">Home</span></a></footer></article></body></html>
