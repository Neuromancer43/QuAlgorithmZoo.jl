<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Circuit Born Machine · Quantum Algorithm Zoo</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-89508993-1', 'auto');
ga('send', 'pageview');
</script><link rel="canonical" href="https://quantumbfs.github.io/QuAlgorithmZoo.jl/latest/tutorial/QCBM/index.html"/><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Quantum Algorithm Zoo</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Tutorial</span><ul><li class="current"><a class="toctext" href>Quantum Circuit Born Machine</a><ul class="internal"><li><a class="toctext" href="#Training-target-1">Training target</a></li><li class="toplevel"><a class="toctext" href="#Build-Circuits-1">Build Circuits</a></li><li><a class="toctext" href="#Building-Blocks-1">Building Blocks</a></li><li><a class="toctext" href="#MMD-Loss-and-Gradients-1">MMD Loss &amp; Gradients</a></li><li><a class="toctext" href="#Optimizer-1">Optimizer</a></li></ul></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Tutorial</li><li><a href>Quantum Circuit Born Machine</a></li></ul><a class="edit-page" href="https://github.com/QuantumBFS/QuAlgorithmZoo.jl/blob/master/examples/QCBM.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Quantum Circuit Born Machine</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Quantum-Circuit-Born-Machine-1" href="#Quantum-Circuit-Born-Machine-1">Quantum Circuit Born Machine</a></h1><p>Quantum circuit born machine is a fresh approach to quantum machine learning. It use a parameterized quantum circuit to learning machine learning tasks with gradient based optimization. In this tutorial, we will show how to implement it with <strong>Yao</strong> (幺) framework.</p><div><pre><code class="language-julia">using Yao, Plots</code></pre></div><div><pre><code class="language-julia">@doc 幺</code></pre><pre><code class="language-none">  Extensible Framework for Quantum Algorithm Design for Humans.

  简单易用可扩展的量子算法设计框架。

  幺 means unitary in Chinese.</code></pre></div><h2><a class="nav-anchor" id="Training-target-1" href="#Training-target-1">Training target</a></h2><p>a gaussian distribution</p><div><pre><code class="language-julia">function gaussian_pdf(n, μ, σ)
    x = collect(1:1&lt;&lt;n)
    pl = @. 1 / sqrt(2pi * σ^2) * exp(-(x - μ)^2 / (2 * σ^2))
    pl / sum(pl)
end</code></pre><pre><code class="language-none">gaussian_pdf (generic function with 1 method)</code></pre></div><div>\[f(x \left| \mu, \sigma^2\right) = \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{(x-\mu)^2}{2\sigma^2}}\]</div><div><pre><code class="language-julia">const n = 6
const maxiter = 20
pg = gaussian_pdf(n, 2^5-0.5, 2^4)
fig = plot(0:1&lt;&lt;n-1, pg)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 600 400">
<defs>
  <clipPath id="clip2600">
    <rect x="0" y="0" width="600" height="400"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip2600)" points="
0,400 600,400 600,0 0,0 
  " fill="#ffffff" fill-opacity="1"/>
<defs>
  <clipPath id="clip2601">
    <rect x="120" y="0" width="421" height="400"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip2600)" points="
23.622,384.252 580.315,384.252 580.315,11.811 23.622,11.811 
  " fill="#ffffff" fill-opacity="1"/>
<defs>
  <clipPath id="clip2602">
    <rect x="23" y="11" width="558" height="373"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip2602)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  39.3775,384.252 39.3775,11.811 
  "/>
<polyline clip-path="url(#clip2602)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  122.74,384.252 122.74,11.811 
  "/>
<polyline clip-path="url(#clip2602)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  206.102,384.252 206.102,11.811 
  "/>
<polyline clip-path="url(#clip2602)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  289.464,384.252 289.464,11.811 
  "/>
<polyline clip-path="url(#clip2602)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  372.826,384.252 372.826,11.811 
  "/>
<polyline clip-path="url(#clip2602)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  456.189,384.252 456.189,11.811 
  "/>
<polyline clip-path="url(#clip2602)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  539.551,384.252 539.551,11.811 
  "/>
<polyline clip-path="url(#clip2602)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  23.622,347.834 580.315,347.834 
  "/>
<polyline clip-path="url(#clip2602)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  23.622,270.779 580.315,270.779 
  "/>
<polyline clip-path="url(#clip2602)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  23.622,193.725 580.315,193.725 
  "/>
<polyline clip-path="url(#clip2602)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  23.622,116.671 580.315,116.671 
  "/>
<polyline clip-path="url(#clip2602)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  23.622,39.6166 580.315,39.6166 
  "/>
<polyline clip-path="url(#clip2600)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  23.622,384.252 580.315,384.252 
  "/>
<polyline clip-path="url(#clip2600)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  23.622,384.252 23.622,11.811 
  "/>
<polyline clip-path="url(#clip2600)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  39.3775,384.252 39.3775,378.665 
  "/>
<polyline clip-path="url(#clip2600)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  122.74,384.252 122.74,378.665 
  "/>
<polyline clip-path="url(#clip2600)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  206.102,384.252 206.102,378.665 
  "/>
<polyline clip-path="url(#clip2600)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  289.464,384.252 289.464,378.665 
  "/>
<polyline clip-path="url(#clip2600)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  372.826,384.252 372.826,378.665 
  "/>
<polyline clip-path="url(#clip2600)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  456.189,384.252 456.189,378.665 
  "/>
<polyline clip-path="url(#clip2600)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  539.551,384.252 539.551,378.665 
  "/>
<polyline clip-path="url(#clip2600)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  23.622,347.834 31.9724,347.834 
  "/>
<polyline clip-path="url(#clip2600)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  23.622,270.779 31.9724,270.779 
  "/>
<polyline clip-path="url(#clip2600)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  23.622,193.725 31.9724,193.725 
  "/>
<polyline clip-path="url(#clip2600)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  23.622,116.671 31.9724,116.671 
  "/>
<polyline clip-path="url(#clip2600)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  23.622,39.6166 31.9724,39.6166 
  "/>
<g clip-path="url(#clip2600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 39.3775, 398.052)" x="39.3775" y="398.052">0</text>
</g>
<g clip-path="url(#clip2600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 122.74, 398.052)" x="122.74" y="398.052">10</text>
</g>
<g clip-path="url(#clip2600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 206.102, 398.052)" x="206.102" y="398.052">20</text>
</g>
<g clip-path="url(#clip2600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 289.464, 398.052)" x="289.464" y="398.052">30</text>
</g>
<g clip-path="url(#clip2600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 372.826, 398.052)" x="372.826" y="398.052">40</text>
</g>
<g clip-path="url(#clip2600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 456.189, 398.052)" x="456.189" y="398.052">50</text>
</g>
<g clip-path="url(#clip2600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 539.551, 398.052)" x="539.551" y="398.052">60</text>
</g>
<g clip-path="url(#clip2600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 17.622, 352.334)" x="17.622" y="352.334">0.005</text>
</g>
<g clip-path="url(#clip2600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 17.622, 275.279)" x="17.622" y="275.279">0.010</text>
</g>
<g clip-path="url(#clip2600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 17.622, 198.225)" x="17.622" y="198.225">0.015</text>
</g>
<g clip-path="url(#clip2600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 17.622, 121.171)" x="17.622" y="121.171">0.020</text>
</g>
<g clip-path="url(#clip2600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 17.622, 44.1166)" x="17.622" y="44.1166">0.025</text>
</g>
<polyline clip-path="url(#clip2602)" style="stroke:#009af9; stroke-width:1; stroke-opacity:1; fill:none" points="
  39.3775,359.432 47.7137,351.294 56.05,342.466 64.3862,332.94 72.7224,322.712 81.0586,311.79 89.3948,300.188 97.7311,287.932 106.067,275.058 114.404,261.612 
  122.74,247.654 131.076,233.252 139.412,218.488 147.748,203.453 156.085,188.249 164.421,172.987 172.757,157.786 181.093,142.773 189.43,128.076 197.766,113.832 
  206.102,100.175 214.438,87.24 222.774,75.1585 231.111,64.0569 239.447,54.0543 247.783,45.2602 256.119,37.7727 264.456,31.6765 272.792,27.0415 281.128,23.9211 
  289.464,22.3518 297.8,22.3518 306.137,23.9211 314.473,27.0415 322.809,31.6765 331.145,37.7727 339.482,45.2602 347.818,54.0543 356.154,64.0569 364.49,75.1585 
  372.826,87.24 381.163,100.175 389.499,113.832 397.835,128.076 406.171,142.773 414.508,157.786 422.844,172.987 431.18,188.249 439.516,203.453 447.852,218.488 
  456.189,233.252 464.525,247.654 472.861,261.612 481.197,275.058 489.534,287.932 497.87,300.188 506.206,311.79 514.542,322.712 522.878,332.94 531.215,342.466 
  539.551,351.294 547.887,359.432 556.223,366.897 564.56,373.711 
  "/>
<polygon clip-path="url(#clip2600)" points="
489.608,62.931 562.315,62.931 562.315,32.691 489.608,32.691 
  " fill="#ffffff" fill-opacity="1"/>
<polyline clip-path="url(#clip2600)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  489.608,62.931 562.315,62.931 562.315,32.691 489.608,32.691 489.608,62.931 
  "/>
<polyline clip-path="url(#clip2600)" style="stroke:#009af9; stroke-width:1; stroke-opacity:1; fill:none" points="
  495.608,47.811 531.608,47.811 
  "/>
<g clip-path="url(#clip2600)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:start;" transform="rotate(0, 537.608, 52.311)" x="537.608" y="52.311">y1</text>
</g>
</svg>
</div><h1><a class="nav-anchor" id="Build-Circuits-1" href="#Build-Circuits-1">Build Circuits</a></h1><h2><a class="nav-anchor" id="Building-Blocks-1" href="#Building-Blocks-1">Building Blocks</a></h2><p>Gates are grouped to become a layer in a circuit, this layer can be <strong>Arbitrary Rotation</strong> or <strong>CNOT entangler</strong>. Which are used as our basic building blocks of <strong>Born Machines</strong>.</p><h3><a class="nav-anchor" id="Arbitrary-Rotation-1" href="#Arbitrary-Rotation-1">Arbitrary Rotation</a></h3><p>Arbitrary Rotation is built with <strong>Rotation Gate on Z</strong>, <strong>Rotation Gate on X</strong> and <strong>Rotation Gate on Z</strong>:</p><div>\[Rz(\theta) \cdot Rx(\theta) \cdot Rz(\theta)\]</div><p>Since our input will be a <span>$|0\dots 0\rangle$</span> state. The first layer of arbitrary rotation can just use <span>$Rx(\theta) \cdot Rz(\theta)$</span> and the last layer of arbitrary rotation could just use <span>$Rz(\theta)\cdot Rx(\theta)$</span></p><p>In <strong>幺</strong>, every Hilbert operator is a <strong>block</strong> type, this includes all <strong>quantum gates</strong> and <strong>quantum oracles</strong>. In general, operators appears in a quantum circuit can be divided into <strong>Composite Blocks</strong> and <strong>Primitive Blocks</strong>.</p><p>We follow the low abstraction principle and thus each block represents a certain approach of calculation. The simplest <strong>Composite Block</strong> is a <strong>Chain Block</strong>, which chains other blocks (oracles) with the same number of qubits together. It is just a simple mathematical composition of operators with same size. e.g.</p><div>\[\text{chain(X, Y, Z)} \iff X \cdot Y \cdot Z\]</div><p>We can construct an arbitrary rotation block by chain <span>$Rz$</span>, <span>$Rx$</span>, <span>$Rz$</span> together.</p><div><pre><code class="language-julia">chain(Rz(0), Rx(0), Rz(0))</code></pre><pre><code class="language-none">Total: 1, DataType: Complex{Float64}
chain
├─ Rot Z gate: 0.0
├─ Rot X gate: 0.0
└─ Rot Z gate: 0.0</code></pre></div><div><pre><code class="language-julia">chain(X)</code></pre><pre><code class="language-none">Total: 1, DataType: Complex{Float64}
chain
└─ X gate</code></pre></div><p><code>Rx</code>, <code>Ry</code> and <code>Rz</code> will construct new rotation gate, which are just shorthands for <code>rot(X, 0.0)</code>, etc.</p><p>Then, let&#39;s pile them up vertically with another method called <strong>rollrepeat</strong></p><div><pre><code class="language-julia">layer(x::Symbol) = layer(Val(x))
layer(::Val{:first}) = rollrepeat(chain(Rx(0), Rz(0)))
rollrepeat(chain(Rx(0), Rz(0)))(4)</code></pre><pre><code class="language-none">Total: 4, DataType: Complex{Float64}
roller
├─ chain
│  ├─ Rot X gate: 0.0
│  └─ Rot Z gate: 0.0
├─ chain
│  ├─ Rot X gate: 0.0
│  └─ Rot Z gate: 0.0
├─ chain
│  ├─ Rot X gate: 0.0
│  └─ Rot Z gate: 0.0
└─ chain
   ├─ Rot X gate: 0.0
   └─ Rot Z gate: 0.0</code></pre></div><p>In <strong>幺</strong>, the factory method <strong>rollrepeat</strong> will construct a block called <strong>Roller</strong>. It is mathematically equivalent to the kronecker product of all operators in this layer:</p><div>\[rollrepeat(n, U) \iff roll(n, \text{i=&gt;U for i = 1:n}) \iff kron(n, \text{i=&gt;U for i=1:n}) \iff U \otimes \dots \otimes U\]</div><div><pre><code class="language-julia">@doc Val</code></pre><pre><code class="language-none">  Val(c)

  Return Val{c}(), which contains no run-time data. Types like this can be
  used to pass the information between functions through the value c, which
  must be an isbits value. The intent of this construct is to be able to
  dispatch on constants directly (at compile time) without having to test the
  value of the constant at run time.

  Examples
  ≡≡≡≡≡≡≡≡≡≡

  julia&gt; f(::Val{true}) = &quot;Good&quot;
  f (generic function with 1 method)

  julia&gt; f(::Val{false}) = &quot;Bad&quot;
  f (generic function with 2 methods)

  julia&gt; f(Val(true))
  &quot;Good&quot;</code></pre></div><div><pre><code class="language-julia">roll(4, i=&gt;X for i = 1:4)</code></pre><pre><code class="language-none">Total: 4, DataType: Complex{Float64}
roller
├─ X gate
├─ X gate
├─ X gate
└─ X gate</code></pre></div><div><pre><code class="language-julia">rollrepeat(4, X)</code></pre><pre><code class="language-none">Total: 4, DataType: Complex{Float64}
roller
├─ X gate
├─ X gate
├─ X gate
└─ X gate</code></pre></div><div><pre><code class="language-julia">kron(4, i=&gt;X for i = 1:4)</code></pre><pre><code class="language-none">Total: 4, DataType: Complex{Float64}
kron
├─ 1=&gt;X gate
├─ 2=&gt;X gate
├─ 3=&gt;X gate
└─ 4=&gt;X gate</code></pre></div><p>However, <code>kron</code> is calculated differently comparing to <code>roll</code>. In principal, <strong>Roller</strong> will be able to calculate small blocks with same size with higher efficiency. But for large blocks <strong>Roller</strong> may be slower. In <strong>幺</strong>, we offer you this freedom to choose the most suitable solution.</p><p>all factory methods will <strong>lazy</strong> evaluate <strong>the first arguements</strong>, which is the number of qubits. It will return a lambda function that requires a single interger input. The instance of desired block will only be constructed until all the information is filled.</p><div><pre><code class="language-julia">rollrepeat(X)</code></pre><pre><code class="language-none">#31 (generic function with 1 method)</code></pre></div><div><pre><code class="language-julia">rollrepeat(X)(4)</code></pre><pre><code class="language-none">Total: 4, DataType: Complex{Float64}
roller
├─ X gate
├─ X gate
├─ X gate
└─ X gate</code></pre></div><p>When you filled all the information in somewhere of the declaration, 幺 will be able to infer the others.</p><div><pre><code class="language-julia">chain(4, rollrepeat(X), rollrepeat(Y))</code></pre><pre><code class="language-none">Total: 4, DataType: Complex{Float64}
chain
├─ roller
│  ├─ X gate
│  ├─ X gate
│  ├─ X gate
│  └─ X gate
└─ roller
   ├─ Y gate
   ├─ Y gate
   ├─ Y gate
   └─ Y gate</code></pre></div><p>We will now define the rest of rotation layers</p><div><pre><code class="language-julia">layer(::Val{:last}) = rollrepeat(chain(Rz(0), Rx(0)))
layer(::Val{:mid}) = rollrepeat(chain(Rz(0), Rx(0), Rz(0)))</code></pre><pre><code class="language-none">layer (generic function with 4 methods)</code></pre></div><h3><a class="nav-anchor" id="CNOT-Entangler-1" href="#CNOT-Entangler-1">CNOT Entangler</a></h3><p>Another component of quantum circuit born machine is several <strong>CNOT</strong> operators applied on different qubits.</p><div><pre><code class="language-julia">entangler(pairs) = chain(control([ctrl, ], target=&gt;X) for (ctrl, target) in pairs)</code></pre><pre><code class="language-none">entangler (generic function with 1 method)</code></pre></div><p>We can then define such a born machine</p><div><pre><code class="language-julia">function QCBM(n, nlayer, pairs)
    circuit = chain(n)
    push!(circuit, layer(:first))

    for i = 1:(nlayer - 1)
        push!(circuit, cache(entangler(pairs)))
        push!(circuit, layer(:mid))
    end

    push!(circuit, cache(entangler(pairs)))
    push!(circuit, layer(:last))

    circuit
end</code></pre><pre><code class="language-none">QCBM (generic function with 1 method)</code></pre></div><p>We use the method <code>cache</code> here to tag the entangler block that it should be cached after its first run, because it is actually a constant oracle. Let&#39;s see what will be constructed</p><div><pre><code class="language-julia">QCBM(4, 1, [1=&gt;2, 2=&gt;3, 3=&gt;4, 4=&gt;1])</code></pre><pre><code class="language-none">Total: 4, DataType: Complex{Float64}
chain
├─ roller
│  ├─ chain
│  │  ├─ Rot X gate: 0.0
│  │  └─ Rot Z gate: 0.0
│  ├─ chain
│  │  ├─ Rot X gate: 0.0
│  │  └─ Rot Z gate: 0.0
│  ├─ chain
│  │  ├─ Rot X gate: 0.0
│  │  └─ Rot Z gate: 0.0
│  └─ chain
│     ├─ Rot X gate: 0.0
│     └─ Rot Z gate: 0.0
├─ chain (Cached)
│  ├─ control(1)
│  │  └─ (2,)=&gt;X gate
│  ├─ control(2)
│  │  └─ (3,)=&gt;X gate
│  ├─ control(3)
│  │  └─ (4,)=&gt;X gate
│  └─ control(4)
│     └─ (1,)=&gt;X gate
└─ roller
   ├─ chain
   │  ├─ Rot Z gate: 0.0
   │  └─ Rot X gate: 0.0
   ├─ chain
   │  ├─ Rot Z gate: 0.0
   │  └─ Rot X gate: 0.0
   ├─ chain
   │  ├─ Rot Z gate: 0.0
   │  └─ Rot X gate: 0.0
   └─ chain
      ├─ Rot Z gate: 0.0
      └─ Rot X gate: 0.0</code></pre></div><h2><a class="nav-anchor" id="MMD-Loss-and-Gradients-1" href="#MMD-Loss-and-Gradients-1">MMD Loss &amp; Gradients</a></h2><p>The MMD loss is describe below:</p><div>\[\begin{aligned}
\mathcal{L} &amp;= \left| \sum_{x} p \theta(x) \phi(x) - \sum_{x} \pi(x) \phi(x) \right|^2\\
            &amp;= \langle K(x, y) \rangle_{x \sim p_{\theta}, y\sim p_{\theta}} - 2 \langle K(x, y)
                  \rangle_{x\sim p_{\theta}, y\sim \pi} + \langle K(x, y) \rangle_{x\sim\pi, y\sim\pi}
\end{aligned}\]</div><p>We will use a squared exponential kernel here.</p><div><pre><code class="language-julia">struct Kernel
    sigma::Float64
    matrix::Matrix{Float64}
end

function Kernel(nqubits, sigma)
    basis = collect(0:(1&lt;&lt;nqubits - 1))
    Kernel(sigma, kernel_matrix(basis, basis, sigma))
end

expect(kernel::Kernel, px::Vector{Float64}, py::Vector{Float64}) = px&#39; * kernel.matrix * py
loss(qcbm, kernel::Kernel, ptrain) = (p = get_prob(qcbm) - ptrain; expect(kernel, p, p))</code></pre><pre><code class="language-none">loss (generic function with 1 method)</code></pre></div><p>Next, let&#39;s define the kernel matrix</p><div><pre><code class="language-julia">function kernel_matrix(x, y, sigma)
    dx2 = (x .- y&#39;).^2
    gamma = 1.0 / (2 * sigma)
    K = exp.(-gamma * dx2)
    K
end</code></pre><pre><code class="language-none">kernel_matrix (generic function with 1 method)</code></pre></div><h3><a class="nav-anchor" id="Gradients-1" href="#Gradients-1">Gradients</a></h3><p>the gradient of MMD loss is</p><div>\[\begin{aligned}
\frac{\partial \mathcal{L}}{\partial \theta^i_l} &amp;= \langle K(x, y) \rangle_{x\sim p_{\theta^+}, y\sim p_{\theta}} - \langle K(x, y) \rangle_{x\sim p_{\theta}^-, y\sim p_{\theta}}\\
&amp;- \langle K(x, y) \rangle _{x\sim p_{\theta^+}, y\sim\pi} + \langle K(x, y) \rangle_{x\sim p_{\theta^-}, y\sim\pi}
\end{aligned}\]</div><p>We have to update one parameter of each rotation gate each time, and calculate its gradient then collect them. Since we will need to calculate the probability from the state vector frequently, let&#39;s define a shorthand first.</p><p>Firstly, you have to define a quantum register. Each run of a QCBM&#39;s input is a simple <span>$|00\cdots 0\rangle$</span> state. We provide string literal <code>bit</code> to help you define one-hot state vectors like this</p><div><pre><code class="language-julia">r = register(bit&quot;0000&quot;)</code></pre><pre><code class="language-none">DefaultRegister{1, Complex{Float64}}
    active qubits: 4/4</code></pre></div><div><pre><code class="language-julia">circuit = QCBM(6, 10, [1=&gt;2, 3=&gt;4, 5=&gt;6, 2=&gt;3, 4=&gt;5, 6=&gt;1]);</code></pre></div><p>Now, we define its shorthand</p><div><pre><code class="language-julia">get_prob(qcbm) = apply!(register(bit&quot;0&quot;^nqubits(qcbm)), qcbm) |&gt; statevec .|&gt; abs2</code></pre><pre><code class="language-none">get_prob (generic function with 1 method)</code></pre></div><p>We will first iterate through each layer contains rotation gates and allocate an array to store our gradient</p><div><pre><code class="language-julia">function gradient(n, nlayers, qcbm, kernel, ptrain)
    prob = get_prob(qcbm)
    grad = zeros(real(datatype(qcbm)), nparameters(qcbm))
    idx = 0
    for ilayer = 1:2:(2 * nlayers + 1)
        idx = grad_layer!(grad, idx, prob, qcbm, qcbm[ilayer], kernel, ptrain)
    end
    grad
end</code></pre><pre><code class="language-none">gradient (generic function with 1 method)</code></pre></div><p>Then we iterate through each rotation gate.</p><div><pre><code class="language-julia">function grad_layer!(grad, idx, prob, qcbm, layer, kernel, ptrain)
    count = idx
    for each_line in blocks(layer)
        for each in blocks(each_line)
            gradient!(grad, count+1, prob, qcbm, each, kernel, ptrain)
            count += 1
        end
    end
    count
end</code></pre><pre><code class="language-none">grad_layer! (generic function with 1 method)</code></pre></div><p>We update each parameter by rotate it <span>$-\pi/2$</span> and <span>$\pi/2$</span></p><div><pre><code class="language-julia">function gradient!(grad, idx, prob, qcbm, gate, kernel, ptrain)
    dispatch!(+, gate, pi / 2)
    prob_pos = get_prob(qcbm)

    dispatch!(-, gate, pi)
    prob_neg = get_prob(qcbm)

    dispatch!(+, gate, pi / 2) # set back

    grad_pos = expect(kernel, prob, prob_pos) - expect(kernel, prob, prob_neg)
    grad_neg = expect(kernel, ptrain, prob_pos) - expect(kernel, ptrain, prob_neg)
    grad[idx] = grad_pos - grad_neg
    grad
end</code></pre><pre><code class="language-none">gradient! (generic function with 1 method)</code></pre></div><h2><a class="nav-anchor" id="Optimizer-1" href="#Optimizer-1">Optimizer</a></h2><p>We will use the Adam optimizer. Since we don&#39;t want you to install another package for this, the following code for this optimizer is copied from <a href="https://github.com/denizyuret/Knet.jl">Knet.jl</a></p><p>Reference: <a href="https://arxiv.org/abs/1412.6980">Kingma, D. P., &amp; Ba, J. L. (2015)</a>. Adam: a Method for Stochastic Optimization. International Conference on Learning Representations, 1–13.</p><div><pre><code class="language-julia">using LinearAlgebra

mutable struct Adam
    lr::AbstractFloat
    gclip::AbstractFloat
    beta1::AbstractFloat
    beta2::AbstractFloat
    eps::AbstractFloat
    t::Int
    fstm
    scndm
end

Adam(; lr=0.001, gclip=0, beta1=0.9, beta2=0.999, eps=1e-8)=Adam(lr, gclip, beta1, beta2, eps, 0, nothing, nothing)

function update!(w, g, p::Adam)
    gclip!(g, p.gclip)
    if p.fstm===nothing; p.fstm=zero(w); p.scndm=zero(w); end
    p.t += 1
    lmul!(p.beta1, p.fstm)
    BLAS.axpy!(1-p.beta1, g, p.fstm)
    lmul!(p.beta2, p.scndm)
    BLAS.axpy!(1-p.beta2, g .* g, p.scndm)
    fstm_corrected = p.fstm / (1 - p.beta1 ^ p.t)
    scndm_corrected = p.scndm / (1 - p.beta2 ^ p.t)
    BLAS.axpy!(-p.lr, @.(fstm_corrected / (sqrt(scndm_corrected) + p.eps)), w)
end

function gclip!(g, gclip)
    if gclip == 0
        g
    else
        gnorm = vecnorm(g)
        if gnorm &lt;= gclip
            g
        else
            BLAS.scale!(gclip/gnorm, g)
        end
    end
end</code></pre><pre><code class="language-none">gclip! (generic function with 1 method)</code></pre></div><p>The training of the quantum circuit is simple, just iterate through the steps.</p><div><pre><code class="language-julia">function train!(qcbm, ptrain, optim; learning_rate=0.1, niter=50)</code></pre></div><p>initialize the parameters</p><div><pre><code class="language-julia">    params = 2pi * rand(nparameters(qcbm))
    dispatch!(qcbm, params)
    kernel = Kernel(nqubits(qcbm), 0.25)

    n, nlayers = nqubits(qcbm), (length(qcbm)-1)÷2
    history = Float64[]

    for i = 1:niter
        grad = gradient(n, nlayers, qcbm, kernel, ptrain)
        curr_loss = loss(qcbm, kernel, ptrain)
        push!(history, curr_loss)
        params = collect(parameters(qcbm))
        update!(params, grad, optim)
        dispatch!(qcbm, params)
    end
    history
end</code></pre><pre><code class="language-none">train! (generic function with 1 method)</code></pre></div><div><pre><code class="language-julia">optim = Adam(lr=0.1)
his = train!(circuit, pg, optim, niter=50, learning_rate=0.1)
plot(1:50, his, xlabel=&quot;iteration&quot;, ylabel=&quot;loss&quot;)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 600 400">
<defs>
  <clipPath id="clip2700">
    <rect x="0" y="0" width="600" height="400"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip2700)" points="
0,400 600,400 600,0 0,0 
  " fill="#ffffff" fill-opacity="1"/>
<defs>
  <clipPath id="clip2701">
    <rect x="120" y="0" width="421" height="400"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip2700)" points="
39.3701,368.504 580.315,368.504 580.315,11.811 39.3701,11.811 
  " fill="#ffffff" fill-opacity="1"/>
<defs>
  <clipPath id="clip2702">
    <rect x="39" y="11" width="542" height="358"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip2702)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  44.265,368.504 44.265,11.811 
  "/>
<polyline clip-path="url(#clip2702)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  148.413,368.504 148.413,11.811 
  "/>
<polyline clip-path="url(#clip2702)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  252.561,368.504 252.561,11.811 
  "/>
<polyline clip-path="url(#clip2702)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  356.709,368.504 356.709,11.811 
  "/>
<polyline clip-path="url(#clip2702)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  460.857,368.504 460.857,11.811 
  "/>
<polyline clip-path="url(#clip2702)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  565.005,368.504 565.005,11.811 
  "/>
<polyline clip-path="url(#clip2702)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  39.3701,358.943 580.315,358.943 
  "/>
<polyline clip-path="url(#clip2702)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  39.3701,276.682 580.315,276.682 
  "/>
<polyline clip-path="url(#clip2702)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  39.3701,194.42 580.315,194.42 
  "/>
<polyline clip-path="url(#clip2702)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  39.3701,112.159 580.315,112.159 
  "/>
<polyline clip-path="url(#clip2702)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  39.3701,29.8971 580.315,29.8971 
  "/>
<polyline clip-path="url(#clip2700)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  39.3701,368.504 580.315,368.504 
  "/>
<polyline clip-path="url(#clip2700)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  39.3701,368.504 39.3701,11.811 
  "/>
<polyline clip-path="url(#clip2700)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  44.265,368.504 44.265,363.154 
  "/>
<polyline clip-path="url(#clip2700)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  148.413,368.504 148.413,363.154 
  "/>
<polyline clip-path="url(#clip2700)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  252.561,368.504 252.561,363.154 
  "/>
<polyline clip-path="url(#clip2700)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  356.709,368.504 356.709,363.154 
  "/>
<polyline clip-path="url(#clip2700)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  460.857,368.504 460.857,363.154 
  "/>
<polyline clip-path="url(#clip2700)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  565.005,368.504 565.005,363.154 
  "/>
<polyline clip-path="url(#clip2700)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  39.3701,358.943 47.4843,358.943 
  "/>
<polyline clip-path="url(#clip2700)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  39.3701,276.682 47.4843,276.682 
  "/>
<polyline clip-path="url(#clip2700)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  39.3701,194.42 47.4843,194.42 
  "/>
<polyline clip-path="url(#clip2700)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  39.3701,112.159 47.4843,112.159 
  "/>
<polyline clip-path="url(#clip2700)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  39.3701,29.8971 47.4843,29.8971 
  "/>
<g clip-path="url(#clip2700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 44.265, 382.304)" x="44.265" y="382.304">0</text>
</g>
<g clip-path="url(#clip2700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 148.413, 382.304)" x="148.413" y="382.304">10</text>
</g>
<g clip-path="url(#clip2700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 252.561, 382.304)" x="252.561" y="382.304">20</text>
</g>
<g clip-path="url(#clip2700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 356.709, 382.304)" x="356.709" y="382.304">30</text>
</g>
<g clip-path="url(#clip2700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 460.857, 382.304)" x="460.857" y="382.304">40</text>
</g>
<g clip-path="url(#clip2700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 565.005, 382.304)" x="565.005" y="382.304">50</text>
</g>
<g clip-path="url(#clip2700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 33.3701, 363.443)" x="33.3701" y="363.443">0.000</text>
</g>
<g clip-path="url(#clip2700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 33.3701, 281.182)" x="33.3701" y="281.182">0.005</text>
</g>
<g clip-path="url(#clip2700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 33.3701, 198.92)" x="33.3701" y="198.92">0.010</text>
</g>
<g clip-path="url(#clip2700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 33.3701, 116.659)" x="33.3701" y="116.659">0.015</text>
</g>
<g clip-path="url(#clip2700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 33.3701, 34.3971)" x="33.3701" y="34.3971">0.020</text>
</g>
<g clip-path="url(#clip2700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:16; text-anchor:middle;" transform="rotate(0, 309.843, 397.6)" x="309.843" y="397.6">iteration</text>
</g>
<g clip-path="url(#clip2700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:16; text-anchor:middle;" transform="rotate(-90, 14.4, 190.157)" x="14.4" y="190.157">loss</text>
</g>
<polyline clip-path="url(#clip2702)" style="stroke:#009af9; stroke-width:1; stroke-opacity:1; fill:none" points="
  54.6798,21.9061 65.0946,141.129 75.5094,190.416 85.9242,232.327 96.3391,279.721 106.754,287.929 117.169,285.14 127.583,282.323 137.998,304.899 148.413,313.597 
  158.828,320.047 169.243,325.744 179.657,330.84 190.072,337.255 200.487,338.259 210.902,336.061 221.317,342.221 231.731,343.684 242.146,342.31 252.561,345.304 
  262.976,349.998 273.391,350.329 283.806,349.164 294.22,351.086 304.635,351.998 315.05,352.514 325.465,354.208 335.88,354.588 346.294,354.878 356.709,355.432 
  367.124,355.115 377.539,355.571 387.954,355.489 398.368,355.785 408.783,356.274 419.198,356.422 429.613,356.964 440.028,357.359 450.442,357.515 460.857,357.386 
  471.272,357.666 481.687,357.856 492.102,357.705 502.516,357.771 512.931,357.991 523.346,358.08 533.761,358.235 544.176,358.409 554.59,358.311 565.005,358.393 
  
  "/>
<polygon clip-path="url(#clip2700)" points="
489.608,62.931 562.315,62.931 562.315,32.691 489.608,32.691 
  " fill="#ffffff" fill-opacity="1"/>
<polyline clip-path="url(#clip2700)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  489.608,62.931 562.315,62.931 562.315,32.691 489.608,32.691 489.608,62.931 
  "/>
<polyline clip-path="url(#clip2700)" style="stroke:#009af9; stroke-width:1; stroke-opacity:1; fill:none" points="
  495.608,47.811 531.608,47.811 
  "/>
<g clip-path="url(#clip2700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:start;" transform="rotate(0, 537.608, 52.311)" x="537.608" y="52.311">y1</text>
</g>
</svg>
</div><div><pre><code class="language-julia">p = get_prob(circuit)
p = plot(0:1&lt;&lt;n-1, p, xlabel=&quot;x&quot;, ylabel=&quot;p&quot;)
plot!(p, 0:1&lt;&lt;n-1, pg)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 600 400">
<defs>
  <clipPath id="clip2800">
    <rect x="0" y="0" width="600" height="400"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip2800)" points="
0,400 600,400 600,0 0,0 
  " fill="#ffffff" fill-opacity="1"/>
<defs>
  <clipPath id="clip2801">
    <rect x="120" y="0" width="421" height="400"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip2800)" points="
39.3701,368.504 580.315,368.504 580.315,11.811 39.3701,11.811 
  " fill="#ffffff" fill-opacity="1"/>
<defs>
  <clipPath id="clip2802">
    <rect x="39" y="11" width="542" height="358"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip2802)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  54.6798,368.504 54.6798,11.811 
  "/>
<polyline clip-path="url(#clip2802)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  135.684,368.504 135.684,11.811 
  "/>
<polyline clip-path="url(#clip2802)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  216.688,368.504 216.688,11.811 
  "/>
<polyline clip-path="url(#clip2802)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  297.692,368.504 297.692,11.811 
  "/>
<polyline clip-path="url(#clip2802)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  378.696,368.504 378.696,11.811 
  "/>
<polyline clip-path="url(#clip2802)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  459.7,368.504 459.7,11.811 
  "/>
<polyline clip-path="url(#clip2802)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  540.704,368.504 540.704,11.811 
  "/>
<polyline clip-path="url(#clip2802)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  39.3701,326.763 580.315,326.763 
  "/>
<polyline clip-path="url(#clip2802)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  39.3701,258.195 580.315,258.195 
  "/>
<polyline clip-path="url(#clip2802)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  39.3701,189.627 580.315,189.627 
  "/>
<polyline clip-path="url(#clip2802)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  39.3701,121.059 580.315,121.059 
  "/>
<polyline clip-path="url(#clip2802)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  39.3701,52.4911 580.315,52.4911 
  "/>
<polyline clip-path="url(#clip2800)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  39.3701,368.504 580.315,368.504 
  "/>
<polyline clip-path="url(#clip2800)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  39.3701,368.504 39.3701,11.811 
  "/>
<polyline clip-path="url(#clip2800)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  54.6798,368.504 54.6798,363.154 
  "/>
<polyline clip-path="url(#clip2800)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  135.684,368.504 135.684,363.154 
  "/>
<polyline clip-path="url(#clip2800)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  216.688,368.504 216.688,363.154 
  "/>
<polyline clip-path="url(#clip2800)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  297.692,368.504 297.692,363.154 
  "/>
<polyline clip-path="url(#clip2800)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  378.696,368.504 378.696,363.154 
  "/>
<polyline clip-path="url(#clip2800)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  459.7,368.504 459.7,363.154 
  "/>
<polyline clip-path="url(#clip2800)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  540.704,368.504 540.704,363.154 
  "/>
<polyline clip-path="url(#clip2800)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  39.3701,326.763 47.4843,326.763 
  "/>
<polyline clip-path="url(#clip2800)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  39.3701,258.195 47.4843,258.195 
  "/>
<polyline clip-path="url(#clip2800)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  39.3701,189.627 47.4843,189.627 
  "/>
<polyline clip-path="url(#clip2800)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  39.3701,121.059 47.4843,121.059 
  "/>
<polyline clip-path="url(#clip2800)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  39.3701,52.4911 47.4843,52.4911 
  "/>
<g clip-path="url(#clip2800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 54.6798, 382.304)" x="54.6798" y="382.304">0</text>
</g>
<g clip-path="url(#clip2800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 135.684, 382.304)" x="135.684" y="382.304">10</text>
</g>
<g clip-path="url(#clip2800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 216.688, 382.304)" x="216.688" y="382.304">20</text>
</g>
<g clip-path="url(#clip2800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 297.692, 382.304)" x="297.692" y="382.304">30</text>
</g>
<g clip-path="url(#clip2800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 378.696, 382.304)" x="378.696" y="382.304">40</text>
</g>
<g clip-path="url(#clip2800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 459.7, 382.304)" x="459.7" y="382.304">50</text>
</g>
<g clip-path="url(#clip2800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 540.704, 382.304)" x="540.704" y="382.304">60</text>
</g>
<g clip-path="url(#clip2800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 33.3701, 331.263)" x="33.3701" y="331.263">0.005</text>
</g>
<g clip-path="url(#clip2800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 33.3701, 262.695)" x="33.3701" y="262.695">0.010</text>
</g>
<g clip-path="url(#clip2800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 33.3701, 194.127)" x="33.3701" y="194.127">0.015</text>
</g>
<g clip-path="url(#clip2800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 33.3701, 125.559)" x="33.3701" y="125.559">0.020</text>
</g>
<g clip-path="url(#clip2800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 33.3701, 56.9911)" x="33.3701" y="56.9911">0.025</text>
</g>
<g clip-path="url(#clip2800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:16; text-anchor:middle;" transform="rotate(0, 309.843, 397.6)" x="309.843" y="397.6">x</text>
</g>
<g clip-path="url(#clip2800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:16; text-anchor:middle;" transform="rotate(-90, 14.4, 190.157)" x="14.4" y="190.157">p</text>
</g>
<polyline clip-path="url(#clip2802)" style="stroke:#009af9; stroke-width:1; stroke-opacity:1; fill:none" points="
  54.6798,340.892 62.7802,333.375 70.8806,331.034 78.981,309.634 87.0814,303.285 95.1819,295.585 103.282,263.677 111.383,270.978 119.483,266.513 127.583,235.183 
  135.684,252.148 143.784,232.434 151.885,202.144 159.985,199.252 168.085,180.374 176.186,194.304 184.286,162.839 192.387,149.914 200.487,122.046 208.587,124.288 
  216.688,113.489 224.788,77.463 232.889,90.5542 240.989,71.016 249.09,73.5182 257.19,69.1933 265.29,31.6673 273.391,41.3291 281.491,39.3936 289.592,34.1725 
  297.692,26.2948 305.792,39.1183 313.893,34.0034 321.993,21.9061 330.094,55.3568 338.194,32.1949 346.294,66.5173 354.395,74.374 362.495,69.3146 370.596,96.3383 
  378.696,90.495 386.796,121.626 394.897,120.119 402.997,130.774 411.098,132.45 419.198,161.359 427.298,155.268 435.399,172.405 443.499,205.454 451.6,205.028 
  459.7,219.105 467.8,243.223 475.901,252.976 484.001,265.223 492.102,281.598 500.202,293.122 508.302,290.166 516.403,300.248 524.503,340.832 532.604,323.701 
  540.704,325.226 548.804,329.29 556.905,342.383 565.005,358.409 
  "/>
<polyline clip-path="url(#clip2802)" style="stroke:#e26f46; stroke-width:1; stroke-opacity:1; fill:none" points="
  54.6798,337.084 62.7802,329.842 70.8806,321.987 78.981,313.51 87.0814,304.409 95.1819,294.689 103.282,284.365 111.383,273.459 119.483,262.002 127.583,250.037 
  135.684,237.616 143.784,224.801 151.885,211.663 159.985,198.284 168.085,184.754 176.186,171.173 184.286,157.646 192.387,144.286 200.487,131.208 208.587,118.533 
  216.688,106.38 224.788,94.8696 232.889,84.1186 240.989,74.2396 249.09,65.3386 257.19,57.5131 265.29,50.8502 273.391,45.4254 281.491,41.3009 289.592,38.5242 
  297.692,37.1277 305.792,37.1277 313.893,38.5242 321.993,41.3009 330.094,45.4254 338.194,50.8502 346.294,57.5131 354.395,65.3386 362.495,74.2396 370.596,84.1186 
  378.696,94.8696 386.796,106.38 394.897,118.533 402.997,131.208 411.098,144.286 419.198,157.646 427.298,171.173 435.399,184.754 443.499,198.284 451.6,211.663 
  459.7,224.801 467.8,237.616 475.901,250.037 484.001,262.002 492.102,273.459 500.202,284.365 508.302,294.689 516.403,304.409 524.503,313.51 532.604,321.987 
  540.704,329.842 548.804,337.084 556.905,343.727 565.005,349.791 
  "/>
<polygon clip-path="url(#clip2800)" points="
489.608,78.051 562.315,78.051 562.315,32.691 489.608,32.691 
  " fill="#ffffff" fill-opacity="1"/>
<polyline clip-path="url(#clip2800)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  489.608,78.051 562.315,78.051 562.315,32.691 489.608,32.691 489.608,78.051 
  "/>
<polyline clip-path="url(#clip2800)" style="stroke:#009af9; stroke-width:1; stroke-opacity:1; fill:none" points="
  495.608,47.811 531.608,47.811 
  "/>
<g clip-path="url(#clip2800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:start;" transform="rotate(0, 537.608, 52.311)" x="537.608" y="52.311">y1</text>
</g>
<polyline clip-path="url(#clip2800)" style="stroke:#e26f46; stroke-width:1; stroke-opacity:1; fill:none" points="
  495.608,62.931 531.608,62.931 
  "/>
<g clip-path="url(#clip2800)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:start;" transform="rotate(0, 537.608, 67.431)" x="537.608" y="67.431">y2</text>
</g>
</svg>
</div><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../../"><span class="direction">Previous</span><span class="title">Home</span></a></footer></article></body></html>
